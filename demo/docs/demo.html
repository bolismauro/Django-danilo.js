<!DOCTYPE html>  <html> <head>   <title>demo.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               demo.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><strong>Danilo.js</strong> is a lightweight javascript framework and router for the browser.
Danilo.js is based on the MOVE pattern, so you should read <a href="http://cirw.in/blog/time-to-move-on">this post</a> first.
Danilo.js use <a href="http://requirejs.org">RequireJS</a> for module definitions.</p>

<p><em>Please note that Events and Operations are asynchronous.</em></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Demo application</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">__hasProp</span> <span class="o">=</span> <span class="p">{}.</span><span class="nx">hasOwnProperty</span><span class="p">,</span>
    <span class="nx">__extends</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">__hasProp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">key</span><span class="p">))</span> <span class="nx">child</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span> <span class="p">}</span> <span class="kd">function</span> <span class="nx">ctor</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span> <span class="p">}</span> <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctor</span><span class="p">();</span> <span class="nx">child</span><span class="p">.</span><span class="nx">__super__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span> <span class="k">return</span> <span class="nx">child</span><span class="p">;</span> <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Require the library</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">require</span><span class="p">([</span><span class="s2">&quot;danilo&quot;</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">danilo</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">Document</span><span class="p">,</span> <span class="nx">User</span><span class="p">,</span> <span class="nx">pippo</span><span class="p">,</span> <span class="nx">pluto</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>You should <strong>initialize the router</strong> at the top of the document.
This parses the DOM and attacch Danilo.js events.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">danilo</span><span class="p">.</span><span class="nx">router</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h2>Defining Models</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>We define a User class which extends danilo.Model</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">User</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_super</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">__extends</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="nx">_super</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nx">User</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">User</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The url for remote CRUD operations. Can be an absolute url, but keep in mind the <em>same origin policy</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">User</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;/user/&#39;</span><span class="p">;</span>
      </pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>This tells Danilo.js to autovalidate each attribute as soon as you call the setter.
If <code>false</code>, validation only occurs by manually calling the <code>validate()</code> instance method.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">User</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">autoValidate</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

      </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h3>Defining Model attributes</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>We define instance attributes in an <code>attr</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">User</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>There are <strong>two kinds of attribute definition</strong>:</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Simple <strong>one-line definition</strong>, by providing the attribute name as the key and its default value as the value</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
        <span class="nx">lengthOfMyUsername</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>or <strong>extended definition</strong> by providing an object whith some properties for this attribute:</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">username</span><span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <ul>
<li>The default value.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">defaultValue</span><span class="o">:</span> <span class="s1">&#39;Default username&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <ul>
<li>A <code>reactive</code> property: <code>true</code> if the attribute should trigger a 
<strong>Reactive Operation</strong> when changed (see the following paragraphs).
Defaults to <code>false</code>.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">reactive</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <ul>
<li>An object containing validators.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">validators</span><span class="o">:</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>we provide some default validators...</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">minLength</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="nx">maxLength</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>...and you can define your own validators as a function taking 
the attribute value as parameter and returning <code>true</code> if the validation succeded; <code>false</code> otherwise.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">firstLetterIsCapital</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attributeValue</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">attributeValue</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">attributeValue</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>More on valiadtors in the following paragraphs.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">};</span>

      <span class="k">return</span> <span class="nx">User</span><span class="p">;</span>
    <span class="p">})(</span><span class="nx">danilo</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h3>Model usage example</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Create a new User with "Pippo" as username.
Pippo's password will be the <code>defaultValue</code> defined in the Model</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pippo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">({</span>
      <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;Pippo&#39;</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Now we set Pippo's password...</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pippo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>...and print some information</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pippo username is &#39;</span><span class="p">,</span> <span class="nx">pippo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pippo password is &#39;</span><span class="p">,</span> <span class="nx">pippo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>We create another User, just for fun</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pluto</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">({</span>
      <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;my_custom_password&#39;</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Here we set Pluto's username</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pluto</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;Pluto&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pluto username is &#39;</span><span class="p">,</span> <span class="nx">pluto</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pluto password is &#39;</span><span class="p">,</span> <span class="nx">pluto</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h2>Defining Operations</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>The <strong>Operation</strong> constructor takes two arguments:</p>

<ul>
<li>a <em>list of triggering events</em></li>
<li>and the function to call when one of the events is triggered</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>This tells Danilo.js to execute this operation 
when the <strong>change</strong> event of the DOMElement with a data-bind="<em>try_login</em>" attribute,
which is a form element in this example (see demo.html).</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <blockquote>
  <p><strong>NOTE:</strong> HTML does not provide a change event for form elements, <em>danilo.router()</em> will 
  fix this.</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;change try_login&#39;</span><span class="p">]</span>

    <span class="p">},</span> </pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>As the second parameter we provide an anonymous function to be executed when one of the
previous element is triggered.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Since we bound this operation to a form element the <em>data</em> object has two properties: </p>

<ul>
<li>data.input is the HTMLInputElement which triggered the change event</li>
<li>data.form is the form which contains that input</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;form is being validated...&#39;</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;you have changed &#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">input</span><span class="p">,</span> <span class="s1">&#39;value, inside form&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">form</span><span class="p">);</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;data-valid&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Now we define an operation that will be executed when the <em>try_login</em> form is submitted.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span>
      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;submit try_login&#39;</span><span class="p">]</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got data&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">attrs</span><span class="p">);</span>
      <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;triggered event&#39;</span><span class="p">);</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <h3>Binding Operations to standard DOM Events</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Danilo.js provides a static <code>bind</code> function that connects
standard DOM Events (click, change, mouseover, ...) to Danilo.js Events</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>This will trigger the <em>test_button_pressed</em> custom event when the 
<code>document.getElementById('custom-event-button')</code>
click event is fired</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click custom-event-button&#39;</span><span class="p">,</span> <span class="s1">&#39;test_button_pressed&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Custom-bound events are fired with a <code>custom</code> prefix:</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span>
      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;custom test_button_pressed&#39;</span><span class="p">]</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p><code>data</code> is the DOMElement the event is attached to</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Custom event triggered from button with id: &#39;&quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h2>Handling validation errors</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>The async way</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span>
      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;validationError User&#39;</span><span class="p">]</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Validation Error: the attribute &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">attribute</span> <span class="o">+</span> <span class="s2">&quot; violates the validator &quot;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">validationName</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">);</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Validation demo</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pluto</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;this is illegal (not capitalized)&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pluto username is now&#39;</span><span class="p">,</span> <span class="nx">pluto</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span>
    <span class="nx">pluto</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;Shrt&#39;</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pluto username is now&#39;</span><span class="p">,</span> <span class="nx">pluto</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <h2>Reactive operations</h2>             </td>             <td class="code">               <div class="highlight"><pre>    
    <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">storage</span><span class="p">;</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">,</span> <span class="s1">&#39;cloudy&#39;</span><span class="p">);</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;bring sunglasses&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span>
      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;reactive weather&#39;</span><span class="p">]</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hey, the weather is changing!&#39;</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">===</span> <span class="s1">&#39;sunny&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;bring sunglasses&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;bring sunglasses&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">,</span> <span class="s1">&#39;sunny&#39;</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="c1">// Reactive event loop is finished</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Weather is &#39;</span><span class="o">+</span><span class="nx">s</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; then I &#39;</span><span class="o">+</span><span class="p">((</span><span class="nx">s</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;bring sunglasses&#39;</span><span class="p">)</span><span class="o">?</span><span class="s1">&#39;should&#39;</span><span class="o">:</span><span class="s1">&#39;should not&#39;</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; bring sunglasses&#39;</span><span class="p">);</span>
    <span class="p">},</span><span class="mi">0</span><span class="p">);</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">,</span> <span class="s1">&#39;cloudy&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Reactive operation bound to a model attribute</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">new</span> <span class="nx">danilo</span><span class="p">.</span><span class="nx">Operation</span><span class="p">({</span>
      <span class="nx">receive</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;reactive User.username&#39;</span><span class="p">]</span>
    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;lengthOfMyUsername&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;My new name is &#39;</span><span class="o">+</span><span class="nx">obj</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;lengthOfMyUsername&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; characters long&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">pippo</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;MyReallyReallyReallyCoolNewUsername&#39;</span><span class="p">)</span>


  <span class="p">});</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 